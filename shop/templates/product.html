{% extends "base.html" %}
{% block content %}
    <div style="display:flex;gap:50px;align-items:flex-start;justify-content:center;margin-top:30px;flex-wrap:wrap;">
        <div>
            {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}" style="width:350px;height:350px;object-fit:cover;border-radius:20px;">
            {% else %}
                <div style="width:350px;height:350px;background:#333;border-radius:20px;"></div>
            {% endif %}
        </div>
        <div style="max-width:500px;">
            <h1>{{ product.name }}</h1>

            <!-- –°–∫–∏–¥–∫–∞ -->
            {% with discount_info=product.get_discount_info %}
                {% if discount_info.0 > 0 %}
                    <p style="font-size:1.2em;color:#aaa;text-decoration:line-through;">
                        –°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞: {{ product.price }} ‚ÇΩ
                    </p>
                    <p style="font-size:1.4em;font-weight:bold;color:var(--neon-pink);">
                        –°–∫–∏–¥–∫–∞ {{ discount_info.0 }}%! –ù–æ–≤–∞—è —Ü–µ–Ω–∞: {{ discount_info.1 }} ‚ÇΩ
                    </p>
                {% else %}
                    <p style="font-size:1.4em;font-weight:bold;background:linear-gradient(to right,var(--neon-blue),white);-webkit-background-clip:text;color:transparent;">
                        {{ product.price }} ‚ÇΩ
                    </p>
                {% endif %}
            {% endwith %}

            <!-- –û—Å—Ç–∞—Ç–æ–∫ -->
            <p style="margin:15px 0;">
                {% if product.stock > 0 %}
                    <span style="color: {% if product.stock <= 3 %}#ff5252{% elif product.stock <= 5 %}#ff9800{% else %}#66bb6a{% endif %}; font-weight:bold;">
                        –í –Ω–∞–ª–∏—á–∏–∏: {{ product.stock }} —à—Ç.
                    </span>
                    {% if product.get_discount_info.0 > 0 %}
                        <span style="color:var(--neon-pink); margin-left:10px;">
                            üî• –°–∫–∏–¥–∫–∞ {{ product.get_discount_info.0 }}%!
                        </span>
                    {% endif %}
                {% else %}
                    <span style="color:#ff5252;font-weight:bold;">–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</span>
                {% endif %}
            </p>
            
            <p>{{ product.description|default:"–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç." }}</p>

            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å –≤—ã–±–æ—Ä–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ -->
            {% if product.stock > 0 %}
                <form method="post" action="{% url 'add_to_cart' product.id %}" style="margin-top:20px;">
                    {% csrf_token %}
                    <div style="display:flex;align-items:center;gap:15px;margin:15px 0;">
                        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                        <input type="number" name="quantity" value="1" min="1" max="{{ product.stock }}" 
                               style="width:80px;padding:8px;border-radius:8px;background:rgba(30,30,60,0.6);color:white;border:1px solid rgba(255,255,255,0.2);">
                        <span style="color:#aaa;">–º–∞–∫—Å. {{ product.stock }}</span>
                    </div>
                    <button type="submit" class="btn" style="color:var(--neon-pink);border-color:var(--neon-pink);">
                        –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </form>
            {% endif %}

            <a href="{% url 'catalog' %}" class="btn" style="margin-top:15px;display:inline-block;">‚Üê –ù–∞–∑–∞–¥</a>
        </div>
    </div>
{% endblock %}